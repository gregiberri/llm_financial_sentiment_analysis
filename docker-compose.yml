version: '3.0'
services: 
  llm_sentiment: 
    image: llm_sentiment
    build:
      context: .
    container_name: llm_sentiment
    ports: 
      - "5577:8888"
      - "5578:22"
    runtime: nvidia
    volumes: 
      - ./:/code
    depends_on:
      - oobabooga
  oobabooga:
    image: oobabooga
    container_name: oobabooga
    build:
      context: oobabooga
      dockerfile: Dockerfile
    command: ["TheBloke/Llama-2-13B-GPTQ", "AutoGPTQ"]
    runtime: nvidia
    volumes:
      - ./models:/models
    ports:
      - 7860:7860
      - 5000:5000
      - 5001:5001
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 4
              capabilities: [gpu]
